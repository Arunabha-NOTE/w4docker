# Create a Docker volume and mount it to a container.

Docker volumes are the preferred mechanism for persisting data generated by and used by Docker containers. They offer a robust and efficient way to separate storage from the container's lifecycle, ensuring data is not lost when a container is stopped, removed, or replaced.

## 1. Create a Docker Volume

A Docker volume can be created using the `docker volume create` command. This establishes a named volume on the Docker host, managed by Docker.

```bash
docker volume create my-data-volume
```

After creation, the volume can be listed to confirm its existence:

```bash
docker volume ls
```

You should see `my-data-volume` in the list of volumes.

## 2. Mount the Volume to a Container

Once a Docker volume is created, it can be mounted to a container when the container is started. This connects the persistent storage to a specific path within the container's filesystem.

Assuming the existence of a previous container (e.g., named `my-web-app` from a previous example), a new container instance can be launched that mounts the `my-data-volume` to a desired path within the container. For instance, to mount it to `/app/data` inside an Ubuntu container:

```bash
docker run -d --name my-web-app-with-volume -v my-data-volume:/app/data ubuntu sleep infinity
```

* `-v my-data-volume:/app/data`: This option specifies the volume to mount (`my-data-volume`) and the absolute path inside the container where it should be mounted (`/app/data`).
* `sleep infinity`: Keeps the container running so we can interact with it.

Verify the container is running:

```bash
docker ps
```

## 3. Verify Data Persistence

To demonstrate data persistence, we can write data to the mounted volume from within the container and then remove and recreate the container, observing that the data remains.

### Step 3.1: Access the container to write data

```bash
docker exec -it my-web-app-with-volume bash
```

### Step 3.2: Inside the container, write a file to the mounted volume path

```bash
# Inside the container
echo "Hello from the volume!" > /app/data/message.txt
exit
```

### Step 3.3: Stop and remove the container (data on the volume persists)

```bash
docker stop my-web-app-with-volume
docker rm my-web-app-with-volume
```

### Step 3.4: Launch a new container, mounting the same volume

```bash
docker run -it --name my-new-web-app-with-volume -v my-data-volume:/app/data ubuntu bash
```

### Step 3.5: Inside the new container, verify the file still exists

```bash
# Inside the new container
cat /app/data/message.txt
exit
```

The content "Hello from the volume!" should be displayed, confirming data persistence.

## 4. Volume Management Commands

Here are some useful commands for managing Docker volumes:

### List all volumes

```bash
docker volume ls
```

### Inspect a specific volume

```bash
docker volume inspect my-data-volume
```

This command shows detailed information about the volume, including its mount point on the host system.

### Remove unused volumes

```bash
docker volume prune
```

**Warning:** This removes all unused volumes. Use with caution.

### Remove a specific volume

```bash
docker volume rm my-data-volume
```

**Note:** You cannot remove a volume that is currently being used by a container.

## 5. Clean Up

### Stop and remove any running containers

```bash
docker stop my-new-web-app-with-volume
docker rm my-new-web-app-with-volume
```

### Remove the volume

```bash
docker volume rm my-data-volume
```

### Verify the volume is removed

```bash
docker volume ls
```

## Key Benefits of Docker Volumes

1. **Data Persistence:** Data survives container restarts, stops, and removals
2. **Performance:** Volumes have better I/O performance compared to bind mounts on Docker Desktop
3. **Portability:** Volumes can be easily backed up, restored, and migrated
4. **Isolation:** Volume content is isolated from the host filesystem
5. **Management:** Docker provides commands to manage volume lifecycle

## Common Use Cases

- **Database storage:** Persisting database files across container updates
- **Application logs:** Storing logs that need to survive container restarts
- **Shared data:** Sharing data between multiple containers
- **Configuration files:** Storing configuration that persists across deployments
- **User uploads:** Persisting user-generated content in web applications

Docker volumes provide a reliable and efficient way to handle persistent data in containerized applications, making them essential for production deployments.